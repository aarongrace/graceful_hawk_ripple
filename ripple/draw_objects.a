	USE	"hawk.h"	
	USE	"stdio.h"
	USE	"stdlib.h"
	USE	"common.h"


;||||||||||||||||||||||||||||||||||||||||||||||||||||||||
	EXT	DRAW_RIPPLE
	INT	DRAW_OBJECTS
;	S	MAIN_STOP
	;S	DEBUG
NODE_POINTER=4
ARSIZE=8
DRAW_OBJECTS:
DEBUG:
	C_S
	LOADCOM	R3,OBJ_LIST
	LOAD	R1,R3,LL_PEEK
	JSRS	R1,R1	; get the head
	
OBJ_LOOP:	; while (node != null){
	TESTR	R3
	BZS	OBJ_LOOP_QT
	STORE	R3,R2,NODE_POINTER-ARSIZE
	LOADS	R3,R3	; loads the pointer to the ripple from the node
	TOSUBR	DRAW_RIPPLE	
	LOAD	R3,R2,NODE_POINTER-ARSIZE
	LOAD	R3,R3,N_NEXT
	BR	OBJ_LOOP

OBJ_LOOP_QT:
	R_S

;|||||||||||||||||||||||||||||||||||||||||||||||||||||||
	EXT	NEWLINKEDLIST
	EXT	RIPPLE_CONSTRUCTOR
	INT 	INITIALIZE_OBJ_LIST
ARSIZE=8
INITIALIZE_OBJ_LIST:
	C_S
	TOSUBR	NEWLINKEDLIST
	SETCOM	R4,R3,OBJ_LIST

	TOSUBR	RIPPLE_CONSTRUCTOR	
	MOVE	R4,R3
	LOADCOM	R3,OBJ_LIST
	LOAD	R1,R3,LL_PUSH
	JSRS	R1,R1

	
	TOSUBR	RIPPLE_CONSTRUCTOR	
	MOVE	R4,R3
	LOADCOM	R3,OBJ_LIST
	LOAD	R1,R3,LL_PUSH
	JSRS	R1,R1


;TODO	test obj_list functions, particularly remove

	R_S


END

	
