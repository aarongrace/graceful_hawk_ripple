	USE	"hawk.h"	
	USE	"stdio.h"
	USE	"stdlib.h"
	USE	"common.h"


;||||||||||||||||||||||||||||||||||||||||||||||||||||||||
	EXT	DRAW_RIPPLE
	EXT	REMOVE_RIPPLE
	INT	DRAW_OBJECTS
;	S	MAIN_STOP
NODE_POINTER=4
ARSIZE=8
DRAW_OBJECTS:
	C_S
	LOADCOM	R3,OBJ_LIST
	LOAD	R1,R3,LL_PEEK
	JSRS	R1,R1	; get the head
	
OBJ_LOOP:	; while (node != null){
	TESTR	R3
	BZS	OBJ_LOOP_QT
	STORE	R3,R2,NODE_POINTER-ARSIZE
	LOADS	R3,R3	; loads the pointer to the ripple from the node
	TOSUBR	DRAW_RIPPLE	
	LOAD	R3,R2,NODE_POINTER-ARSIZE
	LOAD	R3,R3,N_NEXT
	BR	OBJ_LOOP

OBJ_LOOP_QT:
	LOADCOM	R3,OBJ_LIST
	LOAD	R1,R3,LL_PEEK
	JSRS	R1,R1	; get the head
REMOVE_LOOP:	; while (node != null){
	TESTR	R3
	BZS	REMOVE_LOOP_QT
	STORE	R3,R2,NODE_POINTER-ARSIZE
	LOADS	R3,R3	; loads the pointer to the ripple from the node
	LOAD	R6,R3,RIPPLE_LIFE
	TESTR	R6
	BZR	LIFE_NOT_ZERO
	MOVE	R4,R3
	TOSUBR	REMOVE_RIPPLE
LIFE_NOT_ZERO:
	LOAD	R3,R2,NODE_POINTER-ARSIZE
	LOAD	R3,R3,N_NEXT
	BR	REMOVE_LOOP

REMOVE_LOOP_QT:

	R_S



END

	
